<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hands Please - Restaurant App</title>
    <style>
        :root {
            --color-bg-primary: #fcfcf9;
            --color-bg-secondary: #fffffe;
            --color-text-primary: #13343b;
            --color-text-secondary: #626c7c;
            --color-accent: #21808d;
            --color-accent-hover: #1d7480;
            --color-border: rgba(94, 82, 64, 0.2);
            --color-card-bg: #ffffff;
            --color-danger: #b91c1c;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --color-bg-primary: #1f2121;
                --color-bg-secondary: #262828;
                --color-text-primary: #f5f5f5;
                --color-text-secondary: #a7a9a9;
                --color-accent: #32b8c6;
                --color-accent-hover: #2da6b2;
                --color-border: rgba(119, 124, 124, 0.3);
                --color-card-bg: #262828;
                --color-danger: #fecaca;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
        }

        .header {
            background: var(--color-accent);
            color: white;
            padding: 1.5rem 1rem 2.25rem;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .header p {
            font-size: 0.95rem;
            opacity: 0.95;
        }

        .header .admin-login-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .header .admin-login-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 1rem 2.5rem;
        }

        .tabs {
            margin-top: -1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 0.5rem 1rem;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.6);
            background: rgba(255,255,255,0.15);
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            backdrop-filter: blur(8px);
        }

        .tab-btn.active {
            background: #ffffff;
            color: var(--color-accent);
            border-color: #ffffff;
            font-weight: 600;
        }

        .search-bar {
            margin-bottom: 1rem;
        }

        .search-bar input {
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            background: var(--color-card-bg);
            color: var(--color-text-primary);
        }

        .search-bar input:focus {
            outline: 2px solid var(--color-accent);
            border-color: var(--color-accent);
        }

        .filters {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.4rem 0.9rem;
            border: 1px solid var(--color-border);
            background: var(--color-card-bg);
            color: var(--color-text-primary);
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            background: var(--color-accent);
            color: white;
            border-color: var(--color-accent);
        }

        .filter-btn.active {
            background: var(--color-accent);
            color: white;
            border-color: var(--color-accent);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.25rem;
        }

        .card {
            background: var(--color-card-bg);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            position: relative;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
        }

        .card-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
        }

        .card-content {
            padding: 1rem 1.1rem 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.35rem;
        }

        .card-subtitle {
            font-size: 0.85rem;
            color: var(--color-text-secondary);
            margin-bottom: 0.35rem;
        }

        .dietary-tags,
        .tag-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
            margin-bottom: 0.6rem;
        }

        .dietary-tag,
        .pill-tag {
            padding: 0.2rem 0.6rem;
            border-radius: 999px;
            font-size: 0.7rem;
            font-weight: 500;
            background: rgba(33, 128, 141, 0.12);
            color: var(--color-accent);
        }

        .pill-tag.secondary {
            background: rgba(148, 163, 184, 0.2);
            color: var(--color-text-secondary);
        }

        .card-preview {
            color: var(--color-text-secondary);
            font-size: 0.85rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .admin-chip {
            position: absolute;
            top: 0.6rem;
            left: 0.6rem;
            background: rgba(15,118,110,0.9);
            color: white;
            padding: 0.1rem 0.5rem;
            font-size: 0.7rem;
            border-radius: 999px;
            display: none;
        }

        .admin-mode .admin-chip {
            display: inline-block;
        }

        /* Modal */

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 2rem 1rem;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .modal-content {
            background: var(--color-card-bg);
            border-radius: 12px;
            max-width: 900px;
            width: 100%;
            margin: auto;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-close {
            position: sticky;
            top: 0;
            right: 0;
            background: var(--color-accent);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            float: right;
            margin: 1rem 1rem 0 0;
            z-index: 10;
        }

        .modal-close:hover {
            background: var(--color-accent-hover);
        }

        .modal-image {
            width: 100%;
            height: 260px;
            object-fit: cover;
        }

        .modal-body {
            padding: 1.75rem 2rem 2rem;
            clear: both;
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
        }

        .modal-subtitle {
            font-size: 0.95rem;
            color: var(--color-text-secondary);
            margin-bottom: 0.8rem;
        }

        .section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--color-accent);
            margin-bottom: 0.5rem;
            padding-bottom: 0.4rem;
            border-bottom: 2px solid var(--color-border);
        }

        .section-content {
            color: var(--color-text-secondary);
            line-height: 1.7;
        }

        .section-content ul {
            list-style: none;
            padding-left: 0;
        }

        .section-content li {
            padding: 0.35rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.95rem;
        }

        .section-content li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--color-accent);
            font-weight: bold;
        }

        .modification-item {
            background: rgba(33, 128, 141, 0.08);
            padding: 0.6rem;
            border-radius: 8px;
            margin-bottom: 0.45rem;
            font-size: 0.9rem;
        }

        .modification-item strong {
            color: var(--color-text-primary);
        }

        .available {
            color: #059669;
            font-weight: 500;
        }

        .not-available {
            color: #dc2626;
            font-weight: 500;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(33, 128, 141, 0.1) 0%, rgba(33, 128, 141, 0.05) 100%);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--color-accent);
            font-size: 0.95rem;
        }

        /* Admin panel */

        .admin-banner {
            display: none;
            margin-bottom: 0.75rem;
            padding: 0.7rem 0.9rem;
            border-radius: 8px;
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
            font-size: 0.85rem;
        }

        .admin-mode .admin-banner {
            display: block;
        }

        .admin-floating {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            display: none;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 1100;
        }

        .admin-mode .admin-floating {
            display: flex;
        }

        .admin-btn {
            border: none;
            padding: 0.55rem 0.85rem;
            border-radius: 999px;
            cursor: pointer;
            font-size: 0.85rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .admin-btn-primary {
            background: var(--color-accent);
            color: #ffffff;
        }

        .admin-btn-secondary {
            background: #ffffff;
            color: var(--color-text-primary);
        }

        .admin-btn-danger {
            background: var(--color-danger);
            color: #ffffff;
        }

        /* Editor modal */

        .editor-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.7);
            z-index: 1200;
            overflow-y: auto;
            padding: 1.5rem 0.75rem;
        }

        .editor-modal.active {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .editor-content {
            background: var(--color-card-bg);
            border-radius: 12px;
            max-width: 900px;
            width: 100%;
            margin: auto;
            padding: 1.4rem 1.4rem 1.6rem;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .editor-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .editor-close-btn {
            border: none;
            background: transparent;
            font-size: 1.4rem;
            cursor: pointer;
            color: var(--color-text-secondary);
        }

        .editor-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.05fr) minmax(0, 0.95fr);
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .form-group {
            margin-bottom: 0.6rem;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--color-text-secondary);
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.5rem 0.55rem;
            font-size: 0.85rem;
            border-radius: 6px;
            border: 1px solid var(--color-border);
            background: var(--color-bg-secondary);
            color: var(--color-text-primary);
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem 0.9rem;
        }

        .checkbox-row label {
            font-weight: 400;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .list-editor {
            border-radius: 8px;
            border: 1px solid var(--color-border);
            padding: 0.5rem;
            max-height: 210px;
            overflow-y: auto;
            background: var(--color-bg-secondary);
        }

        .list-row {
            display: flex;
            gap: 0.35rem;
            margin-bottom: 0.35rem;
        }

        .list-row input {
            flex: 1;
            padding: 0.4rem 0.5rem;
            border-radius: 5px;
            border: 1px solid var(--color-border);
            font-size: 0.8rem;
        }

        .list-row button {
            border: none;
            background: #fee2e2;
            color: #b91c1c;
            border-radius: 5px;
            padding: 0.25rem 0.4rem;
            font-size: 0.75rem;
            cursor: pointer;
        }

        .list-add-btn {
            margin-top: 0.35rem;
            border: none;
            background: #ecfdf3;
            color: #047857;
            border-radius: 999px;
            padding: 0.25rem 0.6rem;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .mod-row {
            display: grid;
            grid-template-columns: 0.7fr 0.45fr 1.3fr auto;
            gap: 0.35rem;
            margin-bottom: 0.35rem;
        }

        .mod-row input,
        .mod-row select {
            padding: 0.35rem 0.4rem;
            border-radius: 5px;
            border: 1px solid var(--color-border);
            font-size: 0.78rem;
        }

        .editor-actions {
            margin-top: 0.75rem;
            display: flex;
            justify-content: space-between;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .editor-actions-left,
        .editor-actions-right {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .btn {
            border-radius: 999px;
            border: none;
            padding: 0.45rem 0.9rem;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .btn-primary {
            background: var(--color-accent);
            color: #ffffff;
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #111827;
        }

        .btn-danger {
            background: #b91c1c;
            color: #ffffff;
        }

        .small-hint {
            font-size: 0.72rem;
            color: var(--color-text-secondary);
        }

        @media (max-width: 900px) {
            .editor-grid {
                grid-template-columns: minmax(0,1fr);
            }
        }

        @media (max-width: 768px) {
            .menu-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 1rem;
            }

            .header h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="admin-login-btn" onclick="handleAdminButtonClick()">üîí Admin</button>
        <h1>üñêÔ∏è Hands Please</h1>
        <p>Food, Wine, Cocktail & Beer Syllabus</p>
        <p style="font-size: 0.8rem; opacity: 0.85; margin-top: 0.4rem;">&copy; 2026 K Iyer. Internal training tool only.</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" data-tab="food" onclick="switchTab('food')">Food</button>
        <button class="tab-btn" data-tab="wine" onclick="switchTab('wine')">Wine</button>
        <button class="tab-btn" data-tab="cocktails" onclick="switchTab('cocktails')">Cocktails</button>
        <button class="tab-btn" data-tab="beer" onclick="switchTab('beer')">Beer</button>
    </div>

    <div class="container">
        <div id="adminBanner" class="admin-banner">
            <strong>ADMIN MODE:</strong> Tap any card to edit. Use the buttons at the bottom-right to add new items or export all data (for GitHub).
        </div>

        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="üîç Search by name, ingredient, grape, spirit, etc.">
        </div>

        <div id="foodFilters" class="filters">
            <button class="filter-btn active" data-filter="all" onclick="setFoodFilter('all')">All Dishes</button>
            <button class="filter-btn" data-filter="vegan" onclick="setFoodFilter('vegan')">Vegan</button>
            <button class="filter-btn" data-filter="vegetarian" onclick="setFoodFilter('vegetarian')">Vegetarian</button>
            <button class="filter-btn" data-filter="gluten-free" onclick="setFoodFilter('gluten-free')">Gluten Free</button>
            <button class="filter-btn" data-filter="dairy-free" onclick="setFoodFilter('dairy-free')">Dairy Free</button>
        </div>

        <div id="contentGrid" class="menu-grid"></div>
    </div>

    <!-- Detail modal (view mode) -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDetailModal()">&times;</button>
            <div id="modalInner"></div>
        </div>
    </div>

    <!-- Editor modal (add / edit) -->
    <div class="editor-modal" id="editorModal">
        <div class="editor-content">
            <div class="editor-header">
                <div>
                    <div class="editor-title" id="editorTitle"></div>
                    <div class="small-hint" id="editorHint"></div>
                </div>
                <button class="editor-close-btn" onclick="closeEditor()">√ó</button>
            </div>
            <div id="editorBody"></div>
        </div>
    </div>

    <!-- Floating admin controls -->
    <div class="admin-floating" id="adminControls">
        <button class="admin-btn admin-btn-primary" onclick="openAddItem()">
            ‚ûï Add item
        </button>
        <button class="admin-btn admin-btn-secondary" onclick="exportAllData()">
            ‚¨áÔ∏è Export JSON
        </button>
        <button class="admin-btn admin-btn-danger" onclick="logoutAdmin()">
            üîì Exit admin
        </button>
    </div>

    <script>
        // ========================================
        // INITIAL DATA
        // ========================================

        const defaultData = {
            food: [
                {
                    name: "Pan-Seared Atlantic Salmon",
                    image: "https://images.unsplash.com/photo-1485921325833-c519f76c4927?w=800&h=600&fit=crop",
                    dietaries: ["gluten-free", "dairy-free"],
                    ingredients: [
                        "Fresh Atlantic salmon fillet (6oz)",
                        "Extra virgin olive oil",
                        "Sea salt & black pepper",
                        "Fresh lemon",
                        "Fresh dill",
                        "Garlic cloves",
                        "Baby spinach",
                        "Cherry tomatoes"
                    ],
                    miseEnPlace: [
                        "Portion salmon fillets to 6oz each",
                        "Pat dry and season with salt 30 min before service",
                        "Bring to room temperature 20 minutes before cooking",
                        "Prep lemon wedges",
                        "Pick and wash fresh dill",
                        "Peel and slice garlic",
                        "Wash and dry spinach",
                        "Halve cherry tomatoes"
                    ],
                    modifications: [
                        { dietary: "Vegan", available: false, note: "Cannot substitute - fish-based protein" },
                        { dietary: "Vegetarian", available: false, note: "Cannot substitute - fish-based protein" },
                        { dietary: "Gluten-Free", available: true, note: "Already gluten-free as prepared" },
                        { dietary: "Dairy-Free", available: true, note: "Already dairy-free as prepared" },
                        { dietary: "Nut Allergies", available: true, note: "No nuts in dish" }
                    ],
                    interestingInfo: "Our Atlantic salmon is sustainably sourced from Norwegian fjords where the cold, pristine waters produce fish with exceptional omega-3 content. The traditional pan-searing technique creates a perfect crispy skin while keeping the interior moist and tender. Chef's tip: we rest the salmon for 3 minutes after cooking to allow the juices to redistribute throughout the fillet."
                },
                {
                    name: "Wild Mushroom Risotto",
                    image: "https://images.unsplash.com/photo-1476124369491-c4ba3e6dee7e?w=800&h=600&fit=crop",
                    dietaries: ["vegetarian", "gluten-free"],
                    ingredients: [
                        "Arborio rice",
                        "Mixed wild mushrooms (porcini, shiitake, oyster)",
                        "Vegetable stock",
                        "White wine",
                        "Parmesan cheese",
                        "Butter",
                        "Shallots",
                        "Garlic",
                        "Fresh thyme",
                        "Truffle oil"
                    ],
                    miseEnPlace: [
                        "Clean and slice all mushrooms",
                        "Finely dice shallots",
                        "Mince garlic",
                        "Prepare hot vegetable stock (keep warm)",
                        "Grate Parmesan cheese fresh",
                        "Pick thyme leaves",
                        "Measure rice portions (80g per serving)",
                        "Have white wine measured and ready"
                    ],
                    modifications: [
                        { dietary: "Vegan", available: true, note: "Substitute nutritional yeast for Parmesan, use olive oil instead of butter" },
                        { dietary: "Dairy-Free", available: true, note: "Omit Parmesan and butter, add extra truffle oil for richness" },
                        { dietary: "Gluten-Free", available: true, note: "Already gluten-free - ensure stock is GF certified" },
                        { dietary: "Nut Allergies", available: true, note: "No nuts in dish" }
                    ],
                    interestingInfo: "This risotto uses the traditional Mantecatura technique - vigorously stirring butter and cheese into the rice at the end creates a wave-like movement that emulsifies the starches, giving that signature creamy texture without cream. We use a blend of three wild mushrooms foraged seasonally from local forests, each bringing distinct earthy notes. The risotto should flow like lava when plated - 'all'onda' as the Italians say!"
                },
                {
                    name: "Heritage Tomato Caprese",
                    image: "https://images.unsplash.com/photo-1592417817038-d13fd7ab0ea4?w=800&h=600&fit=crop",
                    dietaries: ["vegetarian", "gluten-free"],
                    ingredients: [
                        "Heritage tomatoes (mixed varieties)",
                        "Fresh buffalo mozzarella",
                        "Fresh basil leaves",
                        "Extra virgin olive oil",
                        "Aged balsamic vinegar",
                        "Sea salt flakes",
                        "Cracked black pepper"
                    ],
                    miseEnPlace: [
                        "Slice tomatoes into 1/2 inch rounds",
                        "Drain and slice mozzarella",
                        "Wash and dry basil leaves (keep whole)",
                        "Bring mozzarella to room temperature",
                        "Prepare serving plates",
                        "Have finishing oil and vinegar ready",
                        "Portion salt and pepper"
                    ],
                    modifications: [
                        { dietary: "Vegan", available: true, note: "Substitute cashew-based mozzarella or omit cheese entirely" },
                        { dietary: "Dairy-Free", available: true, note: "Omit mozzarella, double the basil for flavor" },
                        { dietary: "Gluten-Free", available: true, note: "Already gluten-free" },
                        { dietary: "Nut Allergies", available: true, note: "No nuts unless vegan substitution requested" }
                    ],
                    interestingInfo: "We source our heritage tomatoes from a fourth-generation family farm just 30 miles away. These heirloom varieties - including Cherokee Purple, Brandywine, and Green Zebra - have been cultivated for flavor rather than shelf life, making them exponentially more delicious than commercial tomatoes. The buffalo mozzarella arrives three times weekly from a local creamery and is never refrigerated to preserve its delicate texture. True Caprese is about the quality of ingredients, not complexity of technique!"
                },
                {
                    name: "Grilled Lamb Chops",
                    image: "https://images.unsplash.com/photo-1529692236671-f1f6cf9683ba?w=800&h=600&fit=crop",
                    dietaries: ["gluten-free", "dairy-free"],
                    ingredients: [
                        "Frenched lamb chops (3 per portion)",
                        "Fresh rosemary",
                        "Fresh thyme",
                        "Garlic",
                        "Olive oil",
                        "Dijon mustard",
                        "Sea salt",
                        "Black pepper",
                        "Mint leaves"
                    ],
                    miseEnPlace: [
                        "French trim lamb chops if needed",
                        "Bring lamb to room temp 30 min before service",
                        "Prepare herb marinade (rosemary, thyme, garlic, oil)",
                        "Marinate chops minimum 2 hours",
                        "Preheat grill to high heat",
                        "Prep mint garnish",
                        "Have finishing salt ready"
                    ],
                    modifications: [
                        { dietary: "Vegan", available: false, note: "Cannot substitute - meat-based protein" },
                        { dietary: "Vegetarian", available: false, note: "Cannot substitute - meat-based protein" },
                        { dietary: "Gluten-Free", available: true, note: "Already gluten-free" },
                        { dietary: "Dairy-Free", available: true, note: "Already dairy-free" },
                        { dietary: "Nut Allergies", available: true, note: "No nuts in dish" }
                    ],
                    interestingInfo: "Our lamb comes from a heritage breed farm in the hills where the sheep graze on wild herbs, which naturally flavors the meat. The 'Frenching' technique - where the meat is scraped from the bone ends - isn't just for presentation; it prevents burning during high-heat grilling and creates a handle for elegant eating. We rest the chops for exactly 5 minutes after grilling, which is crucial - cutting too early would lose up to 40% of the juices!"
                }
            ],
            wine: [
                {
                    name: "Chablis 1er Cru 'Vaud√©sir'",
                    region: "Chablis, Burgundy, France",
                    grape: "Chardonnay",
                    style: "Crisp, mineral-driven white",
                    glassware: "Medium white wine glass",
                    talkingPoints: "Classic Kimmeridgian limestone terroir, saline finish, green apple and citrus profile, minimal oak to keep it tight and food-friendly."
                }
            ],
            cocktails: [
                {
                    name: "Boulevard Signature Martini",
                    baseSpirit: "Gin",
                    spec: [
                        "2.5 oz London Dry Gin",
                        "0.5 oz Dry Vermouth",
                        "2 dashes Orange Bitters",
                        "Lemon twist or olive"
                    ],
                    glass: "Chilled coupe or martini glass",
                    ice: "Stirred over cubed ice, served up",
                    garnish: "Lemon twist expressed over surface",
                    method: "Stir all ingredients with ice until very cold, strain into chilled glass, garnish with lemon twist.",
                    talkingPoints: "House ratio leans spirit-forward but still balanced. Built to pair with oysters and crudo; citrus oils bridge into bright seafood acidity."
                }
            ],
            beer: [
                {
                    name: "Pilsner Urquell",
                    brewery: "Plze≈àsk√Ω Prazdroj",
                    style: "Czech Pilsner",
                    abv: "4.4",
                    origin: "Plze≈à, Czech Republic",
                    flavourNotes: "Crisp, herbal Saaz hops, gentle bitterness, bready malt backbone, super food-friendly."
                }
            ]
        };

        const STORAGE_KEY = "handsPleaseData_v1";

        let appData = loadData();
        let currentTab = "food";
        let isAdmin = false;
        let foodFilter = "all";
        let searchTerm = "";

        function loadData() {
            try {
                const raw = localStorage.getItem(STORAGE_KEY);
                if (!raw) return structuredClone(defaultData);
                const parsed = JSON.parse(raw);
                return {
                    food: parsed.food || [],
                    wine: parsed.wine || [],
                    cocktails: parsed.cocktails || [],
                    beer: parsed.beer || []
                };
            } catch (e) {
                return structuredClone(defaultData);
            }
        }

        function saveData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
        }

        // ========================================
        // TAB + FILTER + SEARCH
        // ========================================

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll(".tab-btn").forEach(btn => {
                btn.classList.toggle("active", btn.dataset.tab === tab);
            });
            document.getElementById("foodFilters").style.display = tab === "food" ? "flex" : "none";
            renderGrid();
        }

        function setFoodFilter(filter) {
            foodFilter = filter;
            document.querySelectorAll("#foodFilters .filter-btn").forEach(btn => {
                btn.classList.toggle("active", btn.dataset.filter === filter);
            });
            renderGrid();
        }

        document.getElementById("searchInput").addEventListener("input", e => {
            searchTerm = e.target.value.trim().toLowerCase();
            renderGrid();
        });

        // ========================================
        // RENDER GRID
        // ========================================

        function renderGrid() {
            const grid = document.getElementById("contentGrid");
            let items = appData[currentTab] || [];

            // Filter by dietaries for food
            if (currentTab === "food" && foodFilter !== "all") {
                items = items.filter(d => Array.isArray(d.dietaries) && d.dietaries.includes(foodFilter));
            }

            // Search across appropriate fields
            if (searchTerm) {
                items = items.filter(item => matchesSearch(item, currentTab, searchTerm));
            }

            if (!items.length) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--color-text-secondary); padding: 2rem 0;">No items found. Adjust your filters or add a new item in admin mode.</p>';
                return;
            }

            grid.innerHTML = items.map((item, idx) => renderCard(item, idx)).join("");
            document.body.classList.toggle("admin-mode", isAdmin);
            document.getElementById("adminBanner").style.display = isAdmin ? "block" : "none";
        }

        function matchesSearch(item, tab, q) {
            const haystack = [];

            if (tab === "food") {
                haystack.push(item.name || "");
                (item.ingredients || []).forEach(x => haystack.push(x));
                (item.miseEnPlace || []).forEach(x => haystack.push(x));
                haystack.push(item.interestingInfo || "");
                (item.dietaries || []).forEach(x => haystack.push(x));
            } else if (tab === "wine") {
                haystack.push(item.name || "", item.region || "", item.grape || "", item.style || "", item.glassware || "", item.talkingPoints || "");
            } else if (tab === "cocktails") {
                haystack.push(item.name || "", item.baseSpirit || "", item.glass || "", item.ice || "", item.garnish || "", item.method || "", item.talkingPoints || "");
                (item.spec || []).forEach(x => haystack.push(x));
            } else if (tab === "beer") {
                haystack.push(item.name || "", item.brewery || "", item.style || "", item.origin || "", item.flavourNotes || "", String(item.abv || ""));
            }

            const text = haystack.join(" ").toLowerCase();
            return text.includes(q);
        }

        function renderCard(item, index) {
            if (currentTab === "food") {
                return `
                <div class="card" onclick="handleCardClick(${index})">
                    <div class="admin-chip">Edit</div>
                    <img src="${item.image || ""}" alt="${item.name || ""}" class="card-image"
                        onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22600%22%3E%3Crect fill=%22%23e2e8f0%22 width=%22800%22 height=%22600%22/%3E%3Ctext fill=%22%2394a3b8%22 font-family=%22Arial%22 font-size=%2224%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22%3E${encodeURIComponent(item.name || "")}%3C/text%3E%3C/svg%3E'">
                    <div class="card-content">
                        <h3 class="card-title">${item.name || ""}</h3>
                        <div class="dietary-tags">
                            ${(item.dietaries || []).map(d => `<span class="dietary-tag">${formatDietary(d)}</span>`).join("")}
                        </div>
                        <p class="card-preview">${item.interestingInfo || ""}</p>
                    </div>
                </div>`;
            } else if (currentTab === "wine") {
                return `
                <div class="card" onclick="handleCardClick(${index})">
                    <div class="admin-chip">Edit</div>
                    <div class="card-content">
                        <h3 class="card-title">${item.name || ""}</h3>
                        <p class="card-subtitle">${item.region || ""}</p>
                        <div class="tag-row">
                            ${item.grape ? `<span class="pill-tag">${item.grape}</span>` : ""}
                            ${item.style ? `<span class="pill-tag secondary">${item.style}</span>` : ""}
                        </div>
                        <p class="card-preview">${item.talkingPoints || ""}</p>
                    </div>
                </div>`;
            } else if (currentTab === "cocktails") {
                return `
                <div class="card" onclick="handleCardClick(${index})">
                    <div class="admin-chip">Edit</div>
                    <div class="card-content">
                        <h3 class="card-title">${item.name || ""}</h3>
                        <p class="card-subtitle">${item.baseSpirit ? item.baseSpirit + " based" : ""}</p>
                        <div class="tag-row">
                            ${item.glass ? `<span class="pill-tag">${item.glass}</span>` : ""}
                            ${item.ice ? `<span class="pill-tag secondary">${item.ice}</span>` : ""}
                        </div>
                        <p class="card-preview">${item.talkingPoints || ""}</p>
                    </div>
                </div>`;
            } else { // beer
                return `
                <div class="card" onclick="handleCardClick(${index})">
                    <div class="admin-chip">Edit</div>
                    <div class="card-content">
                        <h3 class="card-title">${item.name || ""}</h3>
                        <p class="card-subtitle">${item.brewery || ""}</p>
                        <div class="tag-row">
                            ${item.style ? `<span class="pill-tag">${item.style}</span>` : ""}
                            ${item.abv ? `<span class="pill-tag secondary">${item.abv}% ABV</span>` : ""}
                        </div>
                        <p class="card-preview">${item.flavourNotes || ""}</p>
                    </div>
                </div>`;
            }
        }

        function formatDietary(dietary) {
            if (!dietary) return "";
            return dietary.split("-").map(word =>
                word.charAt(0).toUpperCase() + word.slice(1)
            ).join(" ");
        }

        // ========================================
        // DETAIL MODAL
        // ========================================

        function handleCardClick(index) {
            if (isAdmin) {
                openEditor(currentTab, index);
            } else {
                openDetailModal(currentTab, index);
            }
        }

        function openDetailModal(tab, index) {
            const item = appData[tab][index];
            if (!item) return;
            const modal = document.getElementById("detailModal");
            const inner = document.getElementById("modalInner");

            if (tab === "food") {
                inner.innerHTML = `
                    <img src="${item.image || ""}" alt="${item.name || ""}" class="modal-image" onerror="this.style.display='none'">
                    <div class="modal-body">
                        <h2 class="modal-title">${item.name || ""}</h2>
                        <div class="dietary-tags" style="margin-bottom: 1rem;">
                            ${(item.dietaries || []).map(d => `<span class="dietary-tag">${formatDietary(d)}</span>`).join("")}
                        </div>

                        <div class="section">
                            <h3 class="section-title">üìã Mise en Place for Service</h3>
                            <div class="section-content">
                                <ul>
                                    ${(item.miseEnPlace || []).map(x => `<li>${x}</li>`).join("")}
                                </ul>
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">ü•ò Ingredients</h3>
                            <div class="section-content">
                                <ul>
                                    ${(item.ingredients || []).map(x => `<li>${x}</li>`).join("")}
                                </ul>
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">üîÑ Dietary Modifications</h3>
                            <div class="section-content">
                                ${(item.modifications || []).map(mod => `
                                    <div class="modification-item">
                                        <strong>${mod.dietary || ""}:</strong>
                                        <span class="${mod.available ? "available" : "not-available"}">
                                            ${mod.available ? "‚úì Available" : "‚úó Not Available"}
                                        </span>
                                        <br>
                                        <small>${mod.note || ""}</small>
                                    </div>
                                `).join("")}
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">üí° Interesting Information</h3>
                            <div class="info-box">
                                ${item.interestingInfo || ""}
                            </div>
                        </div>
                    </div>
                `;
            } else if (tab === "wine") {
                inner.innerHTML = `
                    <div class="modal-body">
                        <h2 class="modal-title">${item.name || ""}</h2>
                        <p class="modal-subtitle">${item.region || ""}</p>

                        <div class="dietary-tags" style="margin-bottom: 1rem;">
                            ${item.grape ? `<span class="dietary-tag">${item.grape}</span>` : ""}
                            ${item.style ? `<span class="dietary-tag">${item.style}</span>` : ""}
                            ${item.glassware ? `<span class="dietary-tag">Glass: ${item.glassware}</span>` : ""}
                        </div>

                        <div class="section">
                            <h3 class="section-title">üó£ Key Talking Points</h3>
                            <div class="info-box">
                                ${item.talkingPoints || ""}
                            </div>
                        </div>
                    </div>
                `;
            } else if (tab === "cocktails") {
                inner.innerHTML = `
                    <div class="modal-body">
                        <h2 class="modal-title">${item.name || ""}</h2>
                        <p class="modal-subtitle">${item.baseSpirit ? item.baseSpirit + " based" : ""}</p>

                        <div class="dietary-tags" style="margin-bottom: 1rem;">
                            ${item.glass ? `<span class="dietary-tag">Glass: ${item.glass}</span>` : ""}
                            ${item.ice ? `<span class="dietary-tag">${item.ice}</span>` : ""}
                        </div>

                        <div class="section">
                            <h3 class="section-title">üìè Full Spec</h3>
                            <div class="section-content">
                                <ul>
                                    ${(item.spec || []).map(x => `<li>${x}</li>`).join("")}
                                </ul>
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">ü•∂ Ice & Garnish</h3>
                            <div class="section-content">
                                <p><strong>Ice:</strong> ${item.ice || "‚Äî"}</p>
                                <p><strong>Garnish:</strong> ${item.garnish || "‚Äî"}</p>
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">‚öôÔ∏è Method</h3>
                            <div class="section-content">
                                ${item.method || ""}
                            </div>
                        </div>

                        <div class="section">
                            <h3 class="section-title">üó£ Talking Points</h3>
                            <div class="info-box">
                                ${item.talkingPoints || ""}
                            </div>
                        </div>
                    </div>
                `;
            } else { // beer
                inner.innerHTML = `
                    <div class="modal-body">
                        <h2 class="modal-title">${item.name || ""}</h2>
                        <p class="modal-subtitle">${item.brewery || ""}</p>

                        <div class="dietary-tags" style="margin-bottom: 1rem;">
                            ${item.style ? `<span class="dietary-tag">${item.style}</span>` : ""}
                            ${item.abv ? `<span class="dietary-tag">${item.abv}% ABV</span>` : ""}
                            ${item.origin ? `<span class="dietary-tag">${item.origin}</span>` : ""}
                        </div>

                        <div class="section">
                            <h3 class="section-title">üç∫ Flavour Notes</h3>
                            <div class="info-box">
                                ${item.flavourNotes || ""}
                            </div>
                        </div>
                    </div>
                `;
            }

            modal.classList.add("active");
            document.body.style.overflow = "hidden";
        }

        function closeDetailModal() {
            document.getElementById("detailModal").classList.remove("active");
            document.body.style.overflow = "auto";
        }

        document.getElementById("detailModal").addEventListener("click", e => {
            if (e.target.id === "detailModal") closeDetailModal();
        });

        // ========================================
        // ADMIN LOGIN + CONTROLS
        // ========================================

        function handleAdminButtonClick() {
            if (isAdmin) {
                logoutAdmin();
            } else {
                const pwd = prompt("Enter admin password:");
                if (pwd === "admin2026") {
                    isAdmin = true;
                    document.body.classList.add("admin-mode");
                    renderGrid();
                } else if (pwd !== null) {
                    alert("Incorrect password");
                }
            }
        }

        function logoutAdmin() {
            isAdmin = false;
            document.body.classList.remove("admin-mode");
        }

        function openAddItem() {
            openEditor(currentTab, null);
        }

        function exportAllData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            const date = new Date().toISOString().split("T")[0];
            a.href = url;
            a.download = `hands-please-data-${date}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ========================================
        // EDITOR (ADD / EDIT)
        // ========================================

        let editorState = {
            tab: "food",
            index: null // null = new
        };

        function openEditor(tab, index) {
            editorState = { tab, index };
            const isNew = index === null || index === undefined;
            const modal = document.getElementById("editorModal");
            const titleEl = document.getElementById("editorTitle");
            const hintEl = document.getElementById("editorHint");
            const bodyEl = document.getElementById("editorBody");

            const niceTab = tab.charAt(0).toUpperCase() + tab.slice(1);
            titleEl.textContent = (isNew ? "Add " : "Edit ") + niceTab.slice(0, -1);
            hintEl.textContent = "Changes save to this device immediately. Use Export JSON to update GitHub later.";

            const item = isNew ? createEmptyItem(tab) : structuredClone(appData[tab][index]);

            if (tab === "food") {
                bodyEl.innerHTML = renderFoodEditor(item);
                initFoodEditor(item);
            } else if (tab === "wine") {
                bodyEl.innerHTML = renderWineEditor(item);
                initWineEditor(item);
            } else if (tab === "cocktails") {
                bodyEl.innerHTML = renderCocktailEditor(item);
                initCocktailEditor(item);
            } else {
                bodyEl.innerHTML = renderBeerEditor(item);
                initBeerEditor(item);
            }

            modal.classList.add("active");
            document.body.style.overflow = "hidden";
        }

        function closeEditor() {
            document.getElementById("editorModal").classList.remove("active");
            document.body.style.overflow = "auto";
        }

        function createEmptyItem(tab) {
            if (tab === "food") {
                return {
                    name: "",
                    image: "",
                    dietaries: [],
                    ingredients: [""],
                    miseEnPlace: [""],
                    modifications: [
                        { dietary: "Vegan", available: false, note: "" },
                        { dietary: "Vegetarian", available: false, note: "" },
                        { dietary: "Gluten-Free", available: false, note: "" },
                        { dietary: "Dairy-Free", available: false, note: "" },
                        { dietary: "Nut Allergies", available: true, note: "No nuts in dish" }
                    ],
                    interestingInfo: ""
                };
            } else if (tab === "wine") {
                return {
                    name: "",
                    region: "",
                    grape: "",
                    style: "",
                    glassware: "",
                    talkingPoints: ""
                };
            } else if (tab === "cocktails") {
                return {
                    name: "",
                    baseSpirit: "",
                    spec: [""],
                    glass: "",
                    ice: "",
                    garnish: "",
                    method: "",
                    talkingPoints: ""
                };
            } else {
                return {
                    name: "",
                    brewery: "",
                    style: "",
                    abv: "",
                    origin: "",
                    flavourNotes: ""
                };
            }
        }

        // ---------- FOOD EDITOR ----------

        function renderFoodEditor(item) {
            return `
            <div class="editor-grid">
                <div>
                    <div class="form-group">
                        <label>Dish name</label>
                        <input type="text" id="foodName" value="${escapeHtml(item.name || "")}">
                    </div>
                    <div class="form-group">
                        <label>Image URL</label>
                        <input type="text" id="foodImage" value="${escapeHtml(item.image || "")}">
                        <div class="small-hint">Can be left blank. A placeholder will be shown.</div>
                    </div>
                    <div class="form-group">
                        <label>Dietaries (tags shown on cards)</label>
                        <div class="checkbox-row">
                            ${["vegan", "vegetarian", "gluten-free", "dairy-free", "nut-free"].map(d => `
                                <label>
                                    <input type="checkbox" class="foodDietary" value="${d}" ${item.dietaries && item.dietaries.includes(d) ? "checked" : ""}>
                                    ${formatDietary(d)}
                                </label>
                            `).join("")}
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Interesting information / talking points</label>
                        <textarea id="foodInfo">${escapeHtml(item.interestingInfo || "")}</textarea>
                    </div>
                </div>

                <div>
                    <div class="form-group">
                        <label>Mise en place (one line per bullet)</label>
                        <div class="list-editor" id="foodMepList"></div>
                        <button type="button" class="list-add-btn" onclick="addListRow('foodMepList')">+ Add line</button>
                    </div>
                    <div class="form-group">
                        <label>Ingredients (one line per bullet)</label>
                        <div class="list-editor" id="foodIngList"></div>
                        <button type="button" class="list-add-btn" onclick="addListRow('foodIngList')">+ Add ingredient</button>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Dietary modifications</label>
                <div class="list-editor" id="foodModList"></div>
                <button type="button" class="list-add-btn" onclick="addModRow()">+ Add modification</button>
            </div>

            <div class="editor-actions">
                <div class="editor-actions-left">
                    <button class="btn btn-primary" onclick="saveFoodItem()">Save</button>
                    <button class="btn btn-secondary" onclick="closeEditor()">Cancel</button>
                </div>
                <div class="editor-actions-right">
                    ${editorState.index !== null ? '<button class="btn btn-danger" onclick="deleteCurrentItem()">Delete item</button>' : ""}
                </div>
            </div>
            `;
        }

        function initFoodEditor(item) {
            const mepList = document.getElementById("foodMepList");
            const ingList = document.getElementById("foodIngList");
            const modList = document.getElementById("foodModList");

            renderListEditor(mepList, item.miseEnPlace || [""]);
            renderListEditor(ingList, item.ingredients || [""]);
            renderModEditor(modList, item.modifications || []);
        }

        function saveFoodItem() {
            const name = document.getElementById("foodName").value.trim();
            if (!name) {
                alert("Dish name is required");
                return;
            }
            const image = document.getElementById("foodImage").value.trim();
            const info = document.getElementById("foodInfo").value.trim();

            const dietaries = Array.from(document.querySelectorAll(".foodDietary:checked")).map(cb => cb.value);

            const miseEnPlace = collectListValues("foodMepList");
            const ingredients = collectListValues("foodIngList");
            const modifications = collectModValues();

            const item = { name, image, dietaries, ingredients, miseEnPlace, modifications, interestingInfo: info };

            if (editorState.index === null || editorState.index === undefined) {
                appData.food.push(item);
            } else {
                appData.food[editorState.index] = item;
            }
            saveData();
            closeEditor();
            renderGrid();
        }

        // ---------- WINE EDITOR ----------

        function renderWineEditor(item) {
            return `
            <div class="editor-grid">
                <div>
                    <div class="form-group">
                        <label>Wine name</label>
                        <input type="text" id="wineName" value="${escapeHtml(item.name || "")}">
                    </div>
                    <div class="form-group">
                        <label>Region</label>
                        <input type="text" id="wineRegion" value="${escapeHtml(item.region || "")}">
                    </div>
                    <div class="form-group">
                        <label>Grape</label>
                        <input type="text" id="wineGrape" value="${escapeHtml(item.grape || "")}">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Style</label>
                        <input type="text" id="wineStyle" value="${escapeHtml(item.style || "")}">
                    </div>
                    <div class="form-group">
                        <label>Glassware</label>
                        <input type="text" id="wineGlass" value="${escapeHtml(item.glassware || "")}">
                    </div>
                    <div class="form-group">
                        <label>Key talking points</label>
                        <textarea id="wineTalkingPoints">${escapeHtml(item.talkingPoints || "")}</textarea>
                    </div>
                </div>
            </div>

            <div class="editor-actions">
                <div class="editor-actions-left">
                    <button class="btn btn-primary" onclick="saveWineItem()">Save</button>
                    <button class="btn btn-secondary" onclick="closeEditor()">Cancel</button>
                </div>
                <div class="editor-actions-right">
                    ${editorState.index !== null ? '<button class="btn btn-danger" onclick="deleteCurrentItem()">Delete item</button>' : ""}
                </div>
            </div>
            `;
        }

        function initWineEditor(item) {
            // nothing special to initialise
        }

        function saveWineItem() {
            const name = document.getElementById("wineName").value.trim();
            if (!name) {
                alert("Wine name is required");
                return;
            }
            const region = document.getElementById("wineRegion").value.trim();
            const grape = document.getElementById("wineGrape").value.trim();
            const style = document.getElementById("wineStyle").value.trim();
            const glass = document.getElementById("wineGlass").value.trim();
            const talkingPoints = document.getElementById("wineTalkingPoints").value.trim();

            const item = { name, region, grape, style, glassware: glass, talkingPoints };

            if (editorState.index === null || editorState.index === undefined) {
                appData.wine.push(item);
            } else {
                appData.wine[editorState.index] = item;
            }
            saveData();
            closeEditor();
            renderGrid();
        }

        // ---------- COCKTAIL EDITOR ----------

        function renderCocktailEditor(item) {
            return `
            <div class="editor-grid">
                <div>
                    <div class="form-group">
                        <label>Cocktail name</label>
                        <input type="text" id="cocktailName" value="${escapeHtml(item.name || "")}">
                    </div>
                    <div class="form-group">
                        <label>Base spirit</label>
                        <input type="text" id="cocktailBase" value="${escapeHtml(item.baseSpirit || "")}">
                    </div>
                    <div class="form-group">
                        <label>Glass</label>
                        <input type="text" id="cocktailGlass" value="${escapeHtml(item.glass || "")}">
                    </div>
                    <div class="form-group">
                        <label>Ice</label>
                        <input type="text" id="cocktailIce" value="${escapeHtml(item.ice || "")}">
                    </div>
                    <div class="form-group">
                        <label>Garnish</label>
                        <input type="text" id="cocktailGarnish" value="${escapeHtml(item.garnish || "")}">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Full spec / ingredients (one line per component)</label>
                        <div class="list-editor" id="cocktailSpecList"></div>
                        <button type="button" class="list-add-btn" onclick="addListRow('cocktailSpecList')">+ Add line</button>
                    </div>
                    <div class="form-group">
                        <label>Method</label>
                        <textarea id="cocktailMethod">${escapeHtml(item.method || "")}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Talking points</label>
                        <textarea id="cocktailTalkingPoints">${escapeHtml(item.talkingPoints || "")}</textarea>
                    </div>
                </div>
            </div>

            <div class="editor-actions">
                <div class="editor-actions-left">
                    <button class="btn btn-primary" onclick="saveCocktailItem()">Save</button>
                    <button class="btn btn-secondary" onclick="closeEditor()">Cancel</button>
                </div>
                <div class="editor-actions-right">
                    ${editorState.index !== null ? '<button class="btn btn-danger" onclick="deleteCurrentItem()">Delete item</button>' : ""}
                </div>
            </div>
            `;
        }

        function initCocktailEditor(item) {
            const specList = document.getElementById("cocktailSpecList");
            renderListEditor(specList, item.spec || [""]);
        }

        function saveCocktailItem() {
            const name = document.getElementById("cocktailName").value.trim();
            if (!name) {
                alert("Cocktail name is required");
                return;
            }
            const base = document.getElementById("cocktailBase").value.trim();
            const glass = document.getElementById("cocktailGlass").value.trim();
            const ice = document.getElementById("cocktailIce").value.trim();
            const garnish = document.getElementById("cocktailGarnish").value.trim();
            const method = document.getElementById("cocktailMethod").value.trim();
            const talkingPoints = document.getElementById("cocktailTalkingPoints").value.trim();
            const spec = collectListValues("cocktailSpecList");

            const item = { name, baseSpirit: base, spec, glass, ice, garnish, method, talkingPoints };

            if (editorState.index === null || editorState.index === undefined) {
                appData.cocktails.push(item);
            } else {
                appData.cocktails[editorState.index] = item;
            }
            saveData();
            closeEditor();
            renderGrid();
        }

        // ---------- BEER EDITOR ----------

        function renderBeerEditor(item) {
            return `
            <div class="editor-grid">
                <div>
                    <div class="form-group">
                        <label>Beer name</label>
                        <input type="text" id="beerName" value="${escapeHtml(item.name || "")}">
                    </div>
                    <div class="form-group">
                        <label>Brewery</label>
                        <input type="text" id="beerBrewery" value="${escapeHtml(item.brewery || "")}">
                    </div>
                    <div class="form-group">
                        <label>Style</label>
                        <input type="text" id="beerStyle" value="${escapeHtml(item.style || "")}">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>ABV (%)</label>
                        <input type="number" step="0.1" id="beerAbv" value="${escapeHtml(String(item.abv || ""))}">
                    </div>
                    <div class="form-group">
                        <label>Origin</label>
                        <input type="text" id="beerOrigin" value="${escapeHtml(item.origin || "")}">
                    </div>
                    <div class="form-group">
                        <label>Flavour notes</label>
                        <textarea id="beerFlavour">${escapeHtml(item.flavourNotes || "")}</textarea>
                    </div>
                </div>
            </div>

            <div class="editor-actions">
                <div class="editor-actions-left">
                    <button class="btn btn-primary" onclick="saveBeerItem()">Save</button>
                    <button class="btn btn-secondary" onclick="closeEditor()">Cancel</button>
                </div>
                <div class="editor-actions-right">
                    ${editorState.index !== null ? '<button class="btn btn-danger" onclick="deleteCurrentItem()">Delete item</button>' : ""}
                </div>
            </div>
            `;
        }

        function initBeerEditor(item) {
            // nothing special
        }

        function saveBeerItem() {
            const name = document.getElementById("beerName").value.trim();
            if (!name) {
                alert("Beer name is required");
                return;
            }
            const brewery = document.getElementById("beerBrewery").value.trim();
            const style = document.getElementById("beerStyle").value.trim();
            const abv = document.getElementById("beerAbv").value.trim();
            const origin = document.getElementById("beerOrigin").value.trim();
            const flavourNotes = document.getElementById("beerFlavour").value.trim();

            const item = { name, brewery, style, abv, origin, flavourNotes };

            if (editorState.index === null || editorState.index === undefined) {
                appData.beer.push(item);
            } else {
                appData.beer[editorState.index] = item;
            }
            saveData();
            closeEditor();
            renderGrid();
        }

        // ---------- SHARED EDITOR HELPERS ----------

        function renderListEditor(container, items) {
            if (!items || !items.length) items = [""];
            container.innerHTML = items.map((val, idx) => `
                <div class="list-row">
                    <input type="text" value="${escapeHtml(val)}" data-index="${idx}">
                    <button type="button" onclick="removeListRow('${container.id}', ${idx})">‚úï</button>
                </div>
            `).join("");
        }

        function addListRow(containerId) {
            const container = document.getElementById(containerId);
            const rowCount = container.querySelectorAll(".list-row").length;
            const div = document.createElement("div");
            div.className = "list-row";
            div.innerHTML = `
                <input type="text" value="" data-index="${rowCount}">
                <button type="button" onclick="removeListRow('${containerId}', ${rowCount})">‚úï</button>
            `;
            container.appendChild(div);
        }

        function removeListRow(containerId, index) {
            const container = document.getElementById(containerId);
            const rows = Array.from(container.querySelectorAll(".list-row"));
            if (rows[index]) {
                rows[index].remove();
            }
        }

        function collectListValues(containerId) {
            const container = document.getElementById(containerId);
            const inputs = Array.from(container.querySelectorAll("input"));
            const values = inputs.map(i => i.value.trim()).filter(v => v);
            return values.length ? values : [];
        }

        function renderModEditor(container, mods) {
            if (!mods || !mods.length) {
                mods = [
                    { dietary: "Vegan", available: false, note: "" },
                    { dietary: "Vegetarian", available: false, note: "" },
                    { dietary: "Gluten-Free", available: false, note: "" },
                    { dietary: "Dairy-Free", available: false, note: "" },
                    { dietary: "Nut Allergies", available: true, note: "" }
                ];
            }
            container.innerHTML = mods.map((mod, idx) => `
                <div class="mod-row">
                    <input type="text" value="${escapeHtml(mod.dietary || "")}" placeholder="Dietary" data-mod-field="dietary" data-index="${idx}">
                    <select data-mod-field="available" data-index="${idx}">
                        <option value="true" ${mod.available ? "selected" : ""}>Available</option>
                        <option value="false" ${!mod.available ? "selected" : ""}>Not available</option>
                    </select>
                    <input type="text" value="${escapeHtml(mod.note || "")}" placeholder="Note" data-mod-field="note" data-index="${idx}">
                    <button type="button" onclick="removeModRow(${idx})">‚úï</button>
                </div>
            `).join("");
        }

        function addModRow() {
            const container = document.getElementById("foodModList");
            const idx = container.querySelectorAll(".mod-row").length;
            const div = document.createElement("div");
            div.className = "mod-row";
            div.innerHTML = `
                <input type="text" placeholder="Dietary" data-mod-field="dietary" data-index="${idx}">
                <select data-mod-field="available" data-index="${idx}">
                    <option value="true" selected>Available</option>
                    <option value="false">Not available</option>
                </select>
                <input type="text" placeholder="Note" data-mod-field="note" data-index="${idx}">
                <button type="button" onclick="removeModRow(${idx})">‚úï</button>
            `;
            container.appendChild(div);
        }

        function removeModRow(index) {
            const container = document.getElementById("foodModList");
            const rows = Array.from(container.querySelectorAll(".mod-row"));
            if (rows[index]) rows[index].remove();
        }

        function collectModValues() {
            const container = document.getElementById("foodModList");
            const rows = Array.from(container.querySelectorAll(".mod-row"));
            const mods = [];
            rows.forEach(row => {
                const inputs = row.querySelectorAll("[data-mod-field]");
                const mod = {};
                inputs.forEach(el => {
                    const field = el.dataset.modField;
                    if (field === "available") {
                        mod[field] = el.value === "true";
                    } else {
                        mod[field] = el.value.trim();
                    }
                });
                if (mod.dietary) {
                    mods.push(mod);
                }
            });
            return mods;
        }

        function deleteCurrentItem() {
            if (!confirm("Delete this item? This cannot be undone (unless you have a JSON backup).")) return;
            const { tab, index } = editorState;
            if (index === null || index === undefined) return;
            appData[tab].splice(index, 1);
            saveData();
            closeEditor();
            renderGrid();
        }

        function escapeHtml(str) {
            return String(str || "")
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;");
        }

        // ========================================
        // INIT
        // ========================================

        renderGrid();
    </script>
</body>
</html>
